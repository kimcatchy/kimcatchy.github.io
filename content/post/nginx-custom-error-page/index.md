---
IDX: "8"
slug: "nginx-custom-error-page"
tags:
  - Nginx
description: "Nginx 커스텀 에러 페이지 설정으로 40x/5xx 페이지 통합"
categories:
  - Web
update: "2025-09-20 00:15:00+0900"
date: "2025-09-19 02:55:00+0900"
상태: "Ready"
title: "Nginx Custom Error Page"
---
## 설정하는 이유

사이트 내에 존재하지 않는 경로에 접속할 경우 일반적으로 NodeBB같은 CMS에서는 페이지가 존재하지 않는다는 내용을 출력한다. 하지만 CMS 외부에 접속 가능한 경로를 지정해뒀을 때, 해당 경로에 없는 파일로의 접속을 시도하거나 오류가 나면 nginx에서 응답 코드를 출력한다.

이 글은 21년도에 작성한 글을 티스토리에서 해당 블로그로 옮긴 것인데, 과거의 나는 이런 응답 코드도 서버 공격자에게는 정보가 될 수 있기 때문에 모두 404로 통합하는 것이 좋고, 기왕이면 응답 코드 페이지를 따로 설정해서 서버에 대한 정보(nginx)를 알려주지 않는 것이 좋다고 생각했다..

근데 저 당시에는 내 사이트에 자꾸 이상한 로그를 남기는 사람들이 있어서 그랬고, 오히려 요새는 Cloudflare를 쓴 뒤로 딱히 신경 안 쓰고 있다 ㅋㅋ

- 404.html 같은 에러 페이지를 만들어 Nginx에 매핑하면, 불필요한 서버 정보 노출을 줄이면서 일관된 화면 제공

- `error_page` 지시어로 특정 상태 코드(e.g. 404, 500 등)에 원하는 페이지를 연결하고, `internal`로 직접 접근을 막으면 깔끔하고 안전

## 설정 방법

- 커스텀 에러 페이지(e.g. 404.html)를 준비해 사이트 문서 루트(또는 지정 경로)에 배치

- 서버 블록에 `error_page`를 추가해 코드→페이지 매핑을 설정하고, 해당 페이지 `location`에 `internal` 적용

- 설정 테스트와 적용은 `nginx -t`, `systemctl reload nginx` 순으로 진행

### 예시

```bash
# 상태 코드는 유지하고, 페이지는 커스텀으로 통일
server {
  # 루트/기본 설정
  root /var/www/site;

  # 대표 에러 매핑(404 유지, 5xx 유지)
  error_page 404 /404.html;
  error_page 500 502 503 504 /50x.html;

  # 직접 접근 차단
  location = /404.html { internal; }
  location = /50x.html { internal; }
}
```

```bash
# 보안 노출 최소화를 위해 주요 에러를 404로 통일
server {
  root /var/www/site;

  # 400/401/403/404/5xx 모두 404 상태 + 같은 페이지로 통일
  error_page 400 401 403 404 500 502 503 504 =404 /404.html;

  location = /404.html { internal; }
}
```

- `=`는 상태코드를 바꿈 (e.g. `=404`)

    - 반면 단순 `error_page 404 /404.html;`은 404 상태를 유지

- `=`만 쓰고 코드 미지정 시 백엔드/정적 처리 결과 코드가 그대로 나가 200으로 응답이 될 수 있으니, 통일하려면 `=404` 같이 명시

- `error_page`는 내부 redirect이므로 메서드는 GET으로 변경되며, 에러 페이지는 `internal`로 외부 직접 접근을 막는 것이 좋다.

## 주요 응답 코드

- 1xx (정보): 요청을 받았으며 프로세스를 계속한다.

- 2xx (성공): 요청을 성공적으로 받았으며 인식했고 수용하였다.

- 3xx (리다이렉션): 요청 완료를 위해 추가 작업 조치가 필요하다.

- 4xx (클라이언트 오류): 요청의 문법이 잘못되었거나 요청을 처리할 수 없다.

    - 400(잘못된 요청): 서버가 요청의 구문을 인식하지 못했다.

    - 401(권한 없음): 이 요청은 인증이 필요하다. 서버는 로그인이 필요한 페이지에 대해 이 요청을 제공할 수 있다. 상태 코드 이름이 권한 없음(Unauthorized)으로 되어 있지만 실제 뜻은 인증 안됨(Unauthenticated)에 더 가깝다.

    - 403(Forbidden, 금지됨): 서버가 요청을 거부하고 있다. 예를 들자면, 사용자가 리소스에 대한 필요 권한을 갖고 있지 않다. (401은 인증 실패, 403은 인가 실패라고 볼 수 있음)

    - 404(Not Found, 찾을 수 없음): 서버가 요청한 페이지(Resource)를 찾을 수 없다. 예를 들어 서버에 존재하지 않는 페이지에 대한 요청이 있을 경우 서버는 이 코드를 제공한다.

- 5xx (서버 오류): 서버가 명백히 유효한 요청에 대해 충족을 실패했다.

    - 500(내부 서버 오류): 서버에 오류가 발생하여 요청을 수행할 수 없다.

    - 502 (Bad Gateway, 불량 게이트웨이): 서버가 게이트웨이나 프록시 역할을 하고 있거나 또는 업스트림 서버에서 잘못된 응답을 받았다.

    - 503(서비스를 사용할 수 없음): 서버가 오버로드되었거나 유지관리를 위해 다운되었기 때문에 현재 서버를 사용할 수 없다. 이는 대개 일시적인 상태이다.

    - 504(게이트웨이 시간초과): 서버가 게이트웨이나 프록시 역할을 하고 있거나 또는 업스트림 서버에서 제때 요청을 받지 못했다.

